---
import BaseLayout from "@/layouts/Base";
import PostPreview from "@/components/blog/PostPreviewB";
import SocialMediaLinks from "@/components/SocialMediaLinks";
import {
	filterByLanguage,
	getAllPosts,
	sortMDByDate,
	sortMDByPinned,
} from "@/utils";
import type { CollectionEntry } from "astro:content";

const MAX_POSTS = 10;
const allPosts = await getAllPosts();
const allPostsByDate = sortMDByDate(allPosts);
const allPostsByPinned = sortMDByPinned(allPostsByDate);
const filteredPostsByLanguage = filterByLanguage(allPostsByPinned, "en").slice(0, MAX_POSTS);

const tech: Array<{ title: string; desc: string; href: string }> = [
	{
		title: "NIS2 Directive (EU) 2022/2555",
		desc: "Measures for a high common level of cybersecurity across the Union.",
		href: "https://eur-lex.europa.eu/eli/dir/2022/2555/oj",
	},
	{
		title: "DORA (EU) 2022/2554",
		desc: "Digital Operational Resilience Act for the financial sector.",
		href: "https://eur-lex.europa.eu/eli/reg/2022/2554/oj",
	},
	{
		title: "Cyber Resilience Act (EU) 2024/2847",
		desc: "Cybersecurity requirements for products with digital elements.",
		href: "https://eur-lex.europa.eu/eli/reg/2024/2847/oj",
	},
	{
		title: "EU Cybersecurity Act (EU) 2019/881",
		desc: "Strengthens ENISA and establishes the EU cybersecurity certification framework.",
		href: "https://eur-lex.europa.eu/eli/reg/2019/881/oj",
	},
	{
		title: "CER Directive (EU) 2022/2557",
		desc: "Resilience of critical entities across key sectors.",
		href: "https://eur-lex.europa.eu/eli/dir/2022/2557/oj",
	},
	{
		title: "GDPR (EU) 2016/679",
		desc: "General Data Protection Regulation â€“ security and data protection obligations.",
		href: "https://eur-lex.europa.eu/eli/reg/2016/679/oj",
	},
	{
		title: "eIDAS (EU) 910/2014",
		desc: "Electronic identification and trust services for electronic transactions.",
		href: "https://eur-lex.europa.eu/eli/reg/2014/910/oj",
	},
	{
		title: "NIST Cybersecurity Framework 2.0",
		desc: "Risk-based framework for managing cybersecurity risk.",
		href: "https://www.nist.gov/cyberframework",
	}
];
---

<BaseLayout title="Home">
	<section>
		<h1 class="title">Intro</h1>
		<p class="mb-4 sm:mb-8">
			This blog is maintained by a Cybersecurity Engineer and a Law Student, focusing on the intersection of security, regulation, and compliance in the EU and beyond. Meet the maintainers: Andrei (Cybersecurity Engineer) and Valeria (Law Student).
		</p>
		<div>
			<span>You can find us on: </span>
			<SocialMediaLinks />
		</div>
	</section>

	<section class="mt-8 sm:mt-16">
		<h2 class="title">Posts</h2>
		<ul class="space-y-4 sm:space-y-2">
			{
				filteredPostsByLanguage.map((p) => (
					<PostPreview post={p as CollectionEntry<"blog">} />
				))
			}
		</ul>
	</section>

	<section class="mt-16">
		<h2 class="title">Official references</h2>
		<ul class="space-y-4 sm:space-y-2">
			{
				tech.map(({ href, title }) => (
					<li>
						<a
							href={href}
							target="_blank"
							rel="noopener noreferrer"
							class="cody-link inline-block"
						>
							{title}
						</a>
					</li>
				))
			}
		</ul>
	</section>
</BaseLayout>
